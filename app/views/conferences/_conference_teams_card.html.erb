<div id="conference_teams_card" class="card">
  <div class="card-header">
    <div class="row flex-between-center">
      <div class="col-6 col-sm-auto d-flex align-items-center pe-0">
        <h5 class="fs-9 mb-0 text-nowrap py-2 py-xl-0">
          Teams
          <span class="badge bg-soft-secondary text-secondary ms-2"><%= conference.teams.count %></span>
        </h5>
      </div>
      <div class="col-6 col-sm-auto ms-auto ps-0" style="min-width: 250px;">
        <% if available_teams.any? %>
          <%= form_with url: affiliations_path, scope: :affiliation, method: :post, local: false, data: { controller: "conference-team-add" } do |f| %>
            <%= f.hidden_field :league_id, value: conference.league_id %>
            <%= f.hidden_field :conference_id, value: conference.id %>
            <select name="affiliation[team_id]" data-conference-team-add-target="select" data-action="change->conference-team-add#submit" required>
              <option value="">Add team...</option>
              <% available_teams.each do |team| %>
                <option value="<%= team.id %>"><%= team.location %> <%= team.name %></option>
              <% end %>
            </select>
            <noscript>
              <%= f.submit "Add", class: "btn btn-falcon-primary btn-sm" %>
            </noscript>
          <% end %>
        <% else %>
          <span class="text-muted fs-10">All teams affiliated</span>
        <% end %>
      </div>
    </div>
  </div>
  <div class="card-body px-0 py-0">
    <% if affiliations.any? %>
      <ul class="list-group list-group-flush">
        <% affiliations.each do |affiliation| %>
          <li id="<%= dom_id(affiliation) %>" class="list-group-item <%= affiliation.team.get_default_style_class_name %> py-2 px-3 d-flex fs-9 justify-content-between align-items-center">
            <%= link_to team_path(affiliation.team), data: { turbo_frame: "_top" }, class: "text-decoration-none #{affiliation.team.get_default_style_class_name}" do %>
              <strong><%= affiliation.team.location %></strong> <%= affiliation.team.name %>
            <% end %>
            <%= button_to affiliation_path(affiliation),
                method: :delete,
                form: { data: { turbo_confirm: "Remove #{affiliation.team.location} #{affiliation.team.name} from #{conference.display_name}?" } },
                class: "btn btn-link btn-sm p-0",
                style: "text-shadow: 0 0 3px rgba(0,0,0,0.5); filter: drop-shadow(0 0 2px white);" do %>
              <span class="fas fa-times" style="color: rgba(255,255,255,0.9);"></span>
            <% end %>
          </li>
        <% end %>
      </ul>
    <% else %>
      <div class="p-4 text-center text-muted">
        <p class="mb-0">No teams in this conference yet.</p>
      </div>
    <% end %>
  </div>
</div>
