<div class="row mb-3">
	<div class="col-12">
		<div class="card bg-100 shadow-none border mb-0">
			<div class="card-body p-0">
				<div class="row gx-0 p-2 pb-0 mb-0 flex-between-center" id="header-top">
					<div class="col-auto">
						<div>
							<h6 class="fs-10 mb-0">
								<%= link_to @event, class: "text-muted" do %>
									<span class="fas fa-chevron-left" data-fa-transform="shrink-4 down-1"></span>
									Back to Event
								<% end %>
							</h6>
							<h4 class="text-primary fw-bold mb-0">
								Edit Event:
								<span class="text-info fw-medium"><%= @event.title %></span>
							</h4>
						</div>
					</div>
					<div class="col-auto">
					</div>
				</div>
				<div class="row gx-0 p-2 pt-0" id="header-info">
				</div>
				<% if false %>
					<div class="row gx-0 p-2 bg-700 text-200" id="header-toolbar">
						<div class="col-4 text-200 text-start"><!-- left admin controls --></div>
						<div class="col-4 text-200 text-center"><!-- center admin controls --></div>
						<div class="col-4 text-200 text-end"><!-- right admin controls --></div>
					</div>
				<% end %>
			</div>
		</div>
	</div>
</div>

<div class="row">
  <div class="col-lg-8">
    <div class="card">
      <div class="card-header py-2">
        <h5 class="mb-0">Edit <%= @event.title %></h5>
      </div>
      <div class="card-body">
        <%= render "form", event: @event %>
      </div>
    </div>
  </div>

  <div class="col-lg-4">
    <div class="card mb-3">
      <div class="card-header py-2">
        <h6 class="mb-0">Event Info</h6>
      </div>
      <div class="card-body">
        <dl class="mb-0">
          <dt>Status</dt>
          <dd>
            <% if @event.upcoming? %>
              <span class="badge bg-info">Upcoming</span>
            <% elsif @event.in_progress? %>
              <span class="badge bg-success">In Progress</span>
            <% else %>
              <span class="badge bg-secondary">Completed</span>
            <% end %>
          </dd>

          <dt>Games</dt>
          <dd><%= @event.games.count %> games</dd>

          <dt>Posts</dt>
          <dd><%= @event.posts.count %> posts</dd>
        </dl>
      </div>
    </div>

    <% if @event.games.none? %>
      <div class="card border-danger">
        <div class="card-header py-2 bg-danger text-white">
          <h6 class="mb-0">Danger Zone</h6>
        </div>
        <div class="card-body">
          <p class="text-muted mb-2">Permanently delete this event.</p>
          <%= link_to event_path(@event),
              data: { turbo_method: :delete, turbo_confirm: "Are you sure you want to delete #{@event.title}? This cannot be undone." },
              class: "btn btn-outline-danger btn-sm" do %>
            <span class="fas fa-trash me-1"></span> Delete Event
          <% end %>
        </div>
      </div>
    <% elsif @event.in_progress? && @event.end_date.blank? %>
      <div class="card border-warning">
        <div class="card-header py-2 bg-warning">
          <h6 class="mb-0">End Event</h6>
        </div>
        <div class="card-body">
          <p class="text-muted mb-2">
            <span class="fas fa-info-circle me-1"></span>
            Mark this event as completed by setting the end date to today.
          </p>
          <%= link_to end_event_event_path(@event),
              data: { turbo_method: :patch, turbo_confirm: "End this event now? This will set the end date to today." },
              class: "btn btn-outline-warning btn-sm" do %>
            <span class="fas fa-flag-checkered me-1"></span> End Now
          <% end %>
        </div>
      </div>
    <% end %>
  </div>
</div>
