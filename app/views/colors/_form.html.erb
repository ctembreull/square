<%= form_with(model: color, data: { controller: "color-form" }) do |form| %>
  <% if color.errors.any? %>
    <div class="alert alert-danger">
      <h4 class="alert-heading"><%= pluralize(color.errors.count, "error") %> prohibited this color from being saved:</h4>
      <ul class="mb-0">
        <% color.errors.each do |error| %>
          <li><%= error.full_message %></li>
        <% end %>
      </ul>
    </div>
  <% end %>

  <%= form.hidden_field :team_id %>

  <div class="row">
    <div class="col-md-8">
      <div class="row">
        <div class="col-md-7 mb-3">
          <%= form.label :name, "Color Name", class: "form-label" %>
          <%= form.text_field :name, class: "form-control", required: true, placeholder: "e.g. Tulane Green", autofocus: true %>
        </div>

        <div class="col-md-5 mb-3">
          <%= form.label :hex, "Hex Value", class: "form-label" %>
          <div class="input-group">
            <span class="input-group-text">#</span>
            <%= form.text_field :hex, class: "form-control text-uppercase", required: true, placeholder: "255c4e", maxlength: 6, pattern: "[0-9a-fA-F]{6}", data: { color_form_target: "hex", action: "input->color-form#updateSwatch" } %>
          </div>
        </div>
      </div>

      <div class="mb-3">
        <div class="form-check form-switch">
          <%= form.check_box :primary, class: "form-check-input", role: "switch" %>
          <%= form.label :primary, "Primary color", class: "form-check-label" %>
        </div>
      </div>
    </div>

    <div class="col-md-4 mb-3">
      <%= form.label :hex, "Preview", class: "form-label" %>
      <div data-color-form-target="swatch"
           style="width: 100%; height: 100px; background-color: <%= color.hex.present? ? color.css_hex : '#f8f9fa' %>; border: 1px solid #dee2e6; border-radius: 8px;">
      </div>
    </div>
  </div>

  <div class="d-flex justify-content-end gap-2">
    <%= link_to "Cancel",
        color.team_id ? team_path(color.team_id) : (color.team ? team_path(color.team) : teams_path),
        class: "btn btn-secondary",
        data: { turbo_frame: "_top" } %>
    <%= form.submit class: "btn btn-primary" %>
  </div>
<% end %>
