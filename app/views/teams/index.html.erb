<div class="row mb-3">
	<div class="col-12">
		<div class="card bg-100 shadow-none border mb-0">
			<div class="card-body p-0">
				<div class="row gx-0 p-2 pb-0 mb-0 flex-between-center" id="header-top">
					<div class="col-auto">
						<div>
							<h6 class="fs-10 mb-0">
								Welcome to
							</h6>
							<h4 class="text-primary fw-bold mb-0">
								Squares:
								<span class="text-info fw-medium">Teams Management</span>
							</h4>
						</div>
					</div>
					<div class="col-auto">
						<%= link_to "Create New Team", new_team_path, class: "btn btn-primary btn-sm btn-outline" %>
					</div>
				</div>
				<div class="row gx-0 p-2 pt-0" id="header-info">
				</div>
				<% if false %>
					<div class="row gx-0 p-2 bg-700 text-200" id="header-toolbar">
					</div>
				<% end %>
			</div>
		</div>
	</div>
</div>

<div class="row g-3 mb-3">
	<div class="col">
		<div class="card" id="teamsTable">
			<div class="card-body px-0 pt-0 pb-0">
				<div class="card-header border-bottom border-200 px-0">
					<div class="d-lg-flex justify-content-between">
						<div class="row flex-between-center gy-2 px-x1">
							<div class="col-auto pe-0">
								<h5 class="mb-0">Teams</h5>
							</div>
							<div class="col-auto">
								<%= search_form_for @q, url: teams_path, method: :get, html: { class: "d-flex", data: { turbo_frame: "teams_table", controller: "auto-submit" } } do |f| %>
									<div class="input-group input-search-width">
										<%= f.search_field :location_or_name_or_abbr_cont, class: "form-control form-control-sm shadow-none", placeholder: "Search teams...", "aria-label": "search", data: { action: "input->auto-submit#search" } %>
										<button type="submit" class="btn btn-sm btn-outline-secondary border-300 hover-border-secondary">
											<span class="fas fa-search fs-10"></span>
										</button>
									</div>
									<% if params[:q].present? %>
										<%= link_to "Clear", teams_path, class: "btn btn-sm btn-outline-secondary ms-2" %>
									<% end %>
								<% end %>
							</div>
						</div>
						<div class="border-bottom border-200 my-3 d-lg-none"></div>
						<div class="d-flex align-items-center justify-content-between justify-content-lg-end px-x1">
							<span class="text-muted fs-10"><%= @pagy.count %> teams</span>
						</div>
					</div>
				</div>

				<%= turbo_frame_tag "teams_table" do %>
					<div class="table-responsive scrollbar">
						<table class="table table-sm table-striped fs-10 mb-0 overflow-hidden">
							<thead class="bg-200">
								<tr>
									<th class="text-900" style="width: 5%"><%= sort_link(@q, :abbr, "Abbr") %></th>
									<th class="text-900"><%= sort_link(@q, :location, "Name") %></th>
									<th class="text-900" style="width: 15%">Women's Name</th>
									<th class="text-900" style="width: 6%"><%= sort_link(@q, :level, "Level") %></th>
									<th class="text-900" style="width: 9%"><%= sort_link(@q, :affiliations_count, "Affil.") %></th>
									<th class="text-900" style="width: 7%"><%= sort_link(@q, :colors_count, "Colors") %></th>
									<th class="text-900" style="width: 7%"><%= sort_link(@q, :styles_count, "Styles") %></th>
									<th class="text-900" style="width: 12%"><%= sort_link(@q, :created_at, "Created") %></th>
									<th class="text-900 text-end" style="width: 5%">Actions</th>
								</tr>
							</thead>
							<tbody>
								<% if @teams.any? %>
									<% @teams.each do |team| %>
										<tr>
											<td class="py-0 pt-2"><%= team.abbr %></td>
											<td class="py-0 pt-2"><%= link_to team.display_name, team, class: "fw-semi-bold mb-0", data: { turbo_frame: "_top" } %></td>
											<td class="py-0 pt-2"><%= team.womens_name %></td>
											<td class="py-0 pt-2"><%= team.level %></td>
											<td class="py-0 pt-2"><%= team.affiliations.size %></td>
											<td class="py-0 pt-2"><%= team.colors.size %></td>
											<td class="py-0 pt-2"><%= team.styles.size %></td>
											<td class="py-0 pt-2"><%= team.created_at.strftime("%Y.%m.%d.%H%M") %></td>
											<td class="text-end pe-2 py-0 pt-2">
												<button class="btn btn-link text-600 btn-sm dropdown-toggle dropdown-caret-none btn-reveal float-end" type="button" id="dropdown-team-<%= team.id %>" data-bs-toggle="dropdown" data-boundary="window" aria-haspopup="true" aria-expanded="false" data-bs-reference="parent">
													<span class="fas fa-ellipsis-h fs-10"></span>
												</button>
												<div class="dropdown-menu dropdown-menu-end border py-2" aria-labelledby="dropdown-team-<%= team.id %>" style="">
													<%= link_to "Edit", edit_team_path(team), class: "dropdown-item", target: "_top" %>
													<div class="dropdown-divider"></div>
													<%= link_to "Delete", team_path(team),
															data: { turbo_method: :delete, turbo_confirm: "Are you sure you want to delete this team?" },
															class: "dropdown-item text-danger" %>
												</div>
											</td>
										</tr>
									<% end %>
								<% else %>
									<tr><th colspan="9">No teams found</th></tr>
								<% end %>
							</tbody>
						</table>
					</div>

					<div class="d-flex justify-content-center my-3">
						<%== @pagy.series_nav(:bootstrap) if @pagy.pages > 1 %>
					</div>
				<% end %>
			</div>
		</div>
	</div>
</div>
