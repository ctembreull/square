<!DOCTYPE html>
<html data-bs-theme="light" lang="en-US" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="application-name" content="Square">
    <meta name="mobile-web-app-capable" content="yes">

    <title><%= page_title %></title>

    <%= csrf_meta_tags %>
    <%= csp_meta_tag %>

    <%= yield :head %>

		<%= favicon_link_tag 'favicon.ico' %>

    <%# Falcon Theme Fonts %>
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,500,600,700%7cPoppins:300,400,500,600,700,800,900&display=swap" rel="stylesheet">
    <%# Material Icons %>
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">

    <%# Enable PWA manifest for installable apps (make sure to enable in config/routes.rb too!) %>
    <%#= tag.link rel: "manifest", href: pwa_manifest_path(format: :json) %>

    <link rel="icon" href="/icon.png" type="image/png">
    <link rel="icon" href="/icon.svg" type="image/svg+xml">
    <link rel="apple-touch-icon" href="/icon.png">

    <%# Includes all stylesheet files in app/assets/stylesheets %>
    <%= stylesheet_link_tag :app, "data-turbo-track": "reload" %>
    <%= stylesheet_link_tag "teams", "data-turbo-track": "reload" %>
    <%= stylesheet_link_tag "game", "data-turbo-track": "reload" %>
    <%# Choices.js for searchable selects %>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/choices.js@11.0.6/public/assets/styles/choices.min.css">
    <script src="https://cdn.jsdelivr.net/npm/choices.js@11.0.6/public/assets/scripts/choices.min.js"></script>
    <%# Tippy.js for tooltips %>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tippy.js@6/dist/tippy.css">
    <script>window.process = { env: { NODE_ENV: 'production' }}</script>
    <%= javascript_importmap_tags %>
  </head>

  <body>
    <main class="main" id="top" data-controller="tippy">
			<div class="container" data-layout="container">

				<nav class="navbar navbar-light navbar-glass navbar-top navbar-expand-lg">
					<!-- logo block -->
					<%= link_to root_path, class: "navbar-brand me-1 me-sm-3" do %>
						<div class="d-flex align-items-center">
							<img class="me-2" src="<%= asset_path("gridmark.svg") %>" alt="" width="40" height="40">
							<div class="d-flex flex-column lh-1">
								<span class="font-sans-serif <%= environment_label ? 'fw-bold' : '' %>" style="<%= environment_color ? "color: #{environment_color}" : 'color: var(--falcon-primary)' %>">squares</span>
								<% if environment_label %>
									<small class="text-uppercase fw-semibold" style="font-size: 0.6rem; letter-spacing: 0.1em; color: <%= environment_color %>"><%= environment_label %></small>
								<% end %>
							</div>
						</div>
					<% end %>

					<ul class="navbar-nav" data-top-nav-dropdowns="data-top-nav-dropdowns">
						<li class="nav-item dropdown">
							<a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false" id="events">
								Events
							</a>
							<div class="dropdown-menu dropdown-caret dropdown-menu-card border-0 mt-0" aria-labelledby="events">
                <div class="bg-white dark__bg-1000 rounded-3 py-2">
									<% Event.in_progress.each do |event| %>
										<%= link_to event.title, event_path(event), class: "dropdown-item link-600 fw-medium" %>
									<% end %>
									<%= link_to "Older...", events_path, class: "dropdown-item text-muted" %>
								</div>
              </div>
						</li>
						<% if admin? %>
							<li class="nav-item">
								<%= link_to "Sports", leagues_path, class: "nav-link" %>
							</li>
							<li class="nav-item">
								<%= link_to "Teams", teams_path, class: "nav-link" %>
							</li>
							<li class="nav-item">
								<%= link_to "Players", players_path, class: "nav-link" %>
							</li>
						<% end %>
					</ul>

					<ul class="navbar-nav ms-auto">
						<li class="nav-item dropdown">
							<a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
								<%= current_timezone %>
							</a>
							<div class="dropdown-menu dropdown-menu-end dropdown-caret dropdown-menu-card border-0 mt-0">
								<div class="bg-white dark__bg-1000 rounded-3 py-2">
									<% %w[Hawaii Alaska Pacific\ Time\ (US\ &\ Canada) Arizona Mountain\ Time\ (US\ &\ Canada) Central\ Time\ (US\ &\ Canada) Eastern\ Time\ (US\ &\ Canada)].each do |zone| %>
										<%= button_to zone, timezone_path(timezone: zone), method: :patch, class: "dropdown-item #{'fw-bold' if zone == current_timezone}" %>
									<% end %>
								</div>
							</div>
						</li>
						<% if logged_in? %>
							<li class="nav-item dropdown">
								<a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
									<span class="fas fa-user me-1"></span>
									<%= current_user.display_name || current_user.name %>
								</a>
								<div class="dropdown-menu dropdown-menu-end dropdown-caret dropdown-menu-card border-0 mt-0">
									<div class="bg-white dark__bg-1000 rounded-3 py-2">
										<% if admin? %>
											<%= link_to users_path, class: "dropdown-item" do %>
												<span class="fas fa-users-cog me-2"></span>Manage Users
											<% end %>
											<%= link_to toggle_admin_tools_path, data: { turbo_method: :patch }, class: "dropdown-item" do %>
												<span class="fas fa-<%= show_admin_tools? ? 'eye-slash' : 'eye' %> me-2"></span>
												<%= show_admin_tools? ? "Hide" : "Show" %> Admin Tools
											<% end %>
											<div class="dropdown-divider"></div>
										<% end %>
										<%= button_to "Log Out", logout_path, method: :delete, class: "dropdown-item" %>
									</div>
								</div>
							</li>
						<% else %>
							<li class="nav-item">
								<%= link_to "Log In", login_path, class: "nav-link" %>
							</li>
						<% end %>
					</ul>
				</nav>

				<div class="content">
					<%= yield %>
				</div>

			</div>
    </main>
  </body>
	
</html>
